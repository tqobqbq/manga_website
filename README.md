# 漫画阅读器服务器

一个基于 Python Flask 的漫画阅读器，支持在线浏览本地漫画文件。

## 功能特性

- 📚 多级目录结构支持（漫画/章节）
- 🖼️ 支持多种图片格式（JPG, ### 获取图片列表
```
GET /api/manga/{manga_path}
```

### 获取图片文件
```
GET /api/image/{manga_path}/{filename}
```

### 配置管理
```
GET /api/config          # 获取配置
POST /api/config         # 更新配置
```

### 历史记录
```
GET /api/history         # 获取历史记录
POST /api/history        # 添加历史记录
DELETE /api/history/{id} # 删除历史记录
``` WebP）
- 📖 阅读历史记录和进度保存
- � 多路径管理和快速切换
- �📱 响应式设计，支持移动端
- ⌨️ 键盘快捷键支持
- 👆 移动端触摸手势支持
- 🎯 点击图片左右侧翻页，中间显示进度条
- 🎚️ 全屏进度条，支持拖拽快速跳转到任意页面
- 🔄 自动章节切换和导航提示
- ⚙️ 可配置的阅读方向（从左到右/从右到左）
- 📁 实时显示当前图片文件名
- 🎭 进度条方向跟随阅读方向设置
- 💾 智能图片预加载缓存
- 🎨 现代化 UI 设计

## 安装和运行

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行服务器

```bash
python app.py
```

服务器将在 `http://localhost:5000` 启动

### 3. 添加漫画

支持多级目录结构，可以按以下方式组织漫画：

**单级结构（章节直接包含图片）：**
```
manga_folder/
├── 第一章/
│   ├── 001.jpg
│   ├── 002.jpg
│   └── 003.jpg
├── 第二章/
│   ├── 001.jpg
│   ├── 002.jpg
│   └── 003.jpg
└── ...
```

**多级结构（漫画 -> 章节 -> 图片）：**
```
manga_folder/
├── 漫画A/
│   ├── 第一卷/
│   │   ├── 001.jpg
│   │   └── 002.jpg
│   └── 第二卷/
│       ├── 001.jpg
│       └── 002.jpg
├── 漫画B/
│   ├── 第一章/
│   └── 第二章/
└── ...
```

## 使用说明

### 操作方式

**键盘快捷键：**
- `← / A`: 上一页（根据阅读方向设置）
- `→ / D`: 下一页（根据阅读方向设置）
- `↑ / W`: 上一页（固定方向）
- `↓ / S`: 下一页（固定方向）
- `空格`: 显示/隐藏进度条
- `Esc`: 返回上级或关闭弹窗
- `Enter`: 确认进入下一章（在章节导航弹窗中）

**鼠标操作：**
- 点击图片左侧: 翻页（根据阅读方向设置）
- 点击图片右侧: 翻页（根据阅读方向设置）
- 点击图片中间: 显示进度条
- 拖拽进度条: 快速跳转到任意页面

**移动端手势：**
- 左右滑动: 翻页（根据阅读方向设置）

### 新功能详解

**进度条功能：**
- 点击图片中间区域或按空格键显示
- 拖拽滑块可快速跳转到任意页面
- 显示当前页数和总页数
- 5秒后自动隐藏

**章节导航：**
- 到达最后一页时自动提示进入下一章
- 到达第一页时询问是否进入上一章
- 支持键盘确认或取消操作

**阅读方向设置：**
- 在设置中可选择"从左到右"或"从右到左"
- 影响左右点击区域和滑动手势的行为
- 适应不同地区的阅读习惯

### 功能说明

**路径管理：**
- 在设置中可以添加多个漫画文件夹路径
- 支持快速切换不同的漫画库
- 路径会自动保存到配置文件

**阅读历史：**
- 自动保存阅读进度
- 支持从历史记录快速恢复阅读
- 显示阅读百分比和时间戳
- 可以删除不需要的历史记录

**智能预加载：**
- 可调节预加载缓冲数量（1-8张）
- 自动预加载前后图片，提升阅读体验
- 显示缓存状态

## API 接口

### 获取漫画列表
```
GET /api/manga
```

### 获取漫画图片列表
```
GET /api/manga/{manga_name}
```

### 获取图片文件
```
GET /api/image/{manga_name}/{filename}
```

## 技术栈

- **后端**: Python Flask
- **前端**: HTML5 + CSS3 + JavaScript (ES6+)
- **样式**: CSS Grid + Flexbox
- **图片处理**: Pillow

## 注意事项

1. 支持多级目录结构，可以灵活组织漫画文件
2. 图片文件名建议使用数字编号，便于排序
3. 支持的图片格式：.jpg, .jpeg, .png, .gif, .webp
4. 配置和历史记录会自动保存到本地文件
5. 服务器默认运行在 5000 端口，可在 app.py 中修改
6. 首次使用需要在设置中添加漫画文件夹路径

## 文件结构

```
manga_website/
├── app.py                   # Flask 应用主文件
├── requirements.txt         # Python 依赖包
├── manga_config.json       # 配置文件
├── reading_history.json    # 阅读历史记录
├── templates/              # HTML 模板
│   └── index.html
├── static/                # 静态文件
│   ├── style.css          # 样式文件
│   └── script.js          # JavaScript 文件
└── README.md              # 说明文档
```
